/*
 2014-2016, Rudolf Nickolaev. All rights reserved.
*/
(function(v,w){"function"===typeof define&&define.amd?define(["gostRandom"],w):"object"===typeof exports?module.exports=w(require("gostRandom")):v.GostCipher=w(v.GostRandom)})(this,function(v){function w(b){return 2147483648<=b?b-4294967296:b}function N(b){return 0>b?b+4294967296:b}function H(b){var c=(v=v||r.GostRandom)?new (v||r.GostRandom):$;if(c.getRandomValues)c.getRandomValues(b);else throw new C("Random generator not found");}function q(b){if(b instanceof I)return b;if(b&&b.buffer&&b.buffer instanceof
I)return 0===b.byteOffset&&b.byteLength===b.buffer.byteLength?b.buffer:(new Uint8Array(new Uint8Array(b,b.byteOffset,b.byteLength))).buffer;throw new p("CryptoOperationData required");}function s(b){return new Uint8Array(q(b))}function t(b){return new Uint8Array(s(b))}function D(b){return(b&255)<<24|(b&65280)<<8|b>>8&65280|b>>24&255}function E(b,c){for(var a=0;16>a;++a)b[a]^=c[a]}function O(b){for(var c=0;16>c;++c){for(var a=b,d=0,e=0;16>e;e++)d^=P[Q[e]][a[e]];for(e=16;0<e;--e)a[e]=a[e-1];a[0]=d}}
function R(b,c){E(b,c);for(var a=0;16>a;++a)b[a]=J[b[a]];O(b)}function aa(b){var c=new Uint8Array(160),a=new Uint8Array(16);c.set(s(b));for(b=0;4>b;b++){var d=32*(b+1);c.set(new Uint8Array(c.buffer,32*b,32),d);for(var e=1;9>e;e++){for(var f=8*b+e,g=a,h=0;15>h;h++)g[h]=0;g[15]=f;O(g);var f=new Uint8Array(c.buffer,d,16),g=new Uint8Array(c.buffer,d+16,16),h=a,l=new Uint8Array(f);R(f,h);E(f,g);g.set(l)}}return c}function ba(b,c,a,d){a=a||c.byteOffset;c=new Uint8Array(c.buffer,a,16);if(d){for(d=0;9>d;d++){a=
c;var e=new Uint8Array(b.buffer,16*(9-d),16);E(a,e);for(var e=a,f=0;16>f;++f){for(var g=e,h=g[0],l=0;15>l;l++)g[l]=g[l+1];g[15]=h;for(l=h=0;16>l;l++)h^=P[Q[l]][g[l]];g[15]=h}for(e=0;16>e;++e)a[e]=ca[a[e]]}E(c,new Uint8Array(b.buffer,0,16))}else{for(d=0;9>d;d++)R(c,new Uint8Array(b.buffer,16*d,16));E(c,new Uint8Array(b.buffer,144,16))}}function K(b,c,a){a=c[0]+a&4294967295;var d=b[0+(a>>0&15)]<<0,d=d|b[16+(a>>4&15)]<<4,d=d|b[32+(a>>8&15)]<<8,d=d|b[48+(a>>12&15)]<<12,d=d|b[64+(a>>16&15)]<<16,d=d|b[80+
(a>>20&15)]<<20,d=d|b[96+(a>>24&15)]<<24,d=d|b[112+(a>>28&15)]<<28;a=(d<<11|d>>>21)^c[1];c[1]=c[0];c[0]=a}function da(b,c,a){a=a||c.byteOffset;var d=this.sBox;c=new Int32Array(c.buffer,a,2);for(a=0;32>a;a++)K(d,c,b[a]);b=c[0];c[0]=c[1];c[1]=b}function ea(b,c,a){a=a||c.byteOffset;var d=this.sBox;c=new Int32Array(c.buffer,a,2);a=D(c[0]);c[0]=D(c[1]);c[1]=a;for(a=0;32>a;a++)K(d,c,b[a]);c[0]=D(c[0]);c[1]=D(c[1])}function fa(b,c){for(var a=new Int32Array(32),d=new Int32Array(q(b)),e=0;8>e;e++)a[e]=d[e];
if(c){for(e=0;8>e;e++)a[e+8]=a[7-e];for(e=0;8>e;e++)a[e+16]=a[7-e]}else{for(e=0;8>e;e++)a[e+8]=a[e];for(e=0;8>e;e++)a[e+16]=a[e]}for(e=0;8>e;e++)a[e+24]=a[7-e];return a}function ga(b,c){for(var a=new Int32Array(32),d=new Int32Array(q(b)),e=0;8>e;e++)a[e]=D(d[e]);if(c){for(e=0;8>e;e++)a[e+8]=a[7-e];for(e=0;8>e;e++)a[e+16]=a[7-e]}else{for(e=0;8>e;e++)a[e+8]=a[e];for(e=0;8>e;e++)a[e+16]=a[e]}for(e=0;8>e;e++)a[e+24]=a[7-e];return a}function x(b,c){for(var a=this.pad(s(c)),d=this.blockSize,e=a.byteLength/
d,f=this.keySchedule(b),g=0;g<e;g++)this.process(f,a,d*g);return a.buffer}function F(b,c){for(var a=t(c),d=this.blockSize,e=a.byteLength/d,f=this.keySchedule(b,1),g=0;g<e;g++)this.process(f,a,d*g,1);return this.unpad(a).buffer}function S(b,c,a){a=new Uint8Array(a||this.iv);c=t(c);for(var d=a.length,e=new Uint8Array(d),f=this.shiftBits>>3,g=c.length,h=g%f,g=(g-h)/f,l=this.keySchedule(b),k=0;k<g;k++){for(var m=0;m<d;m++)e[m]=a[m];this.process(l,a);for(m=0;m<f;m++)c[k*f+m]^=a[m];for(m=0;m<d-f;m++)a[m]=
e[f+m];for(m=0;m<f;m++)a[d-f+m]=c[k*f+m];b=this.keyMeshing(b,a,k,l)}if(0<h)for(this.process(l,a),k=0;k<h;k++)c[g*f+k]^=a[k];return c.buffer}function ha(b,c,a){a=new Uint8Array(a||this.iv);c=t(c);for(var d=a.length,e=new Uint8Array(d),f=this.shiftBits>>3,g=c.length,h=g%f,g=(g-h)/f,l=this.keySchedule(b),k=0;k<g;k++){for(var m=0;m<d;m++)e[m]=a[m];this.process(l,a);for(m=0;m<f;m++)e[m]=c[k*f+m],c[k*f+m]^=a[m];for(m=0;m<d-f;m++)a[m]=e[f+m];for(m=0;m<f;m++)a[d-f+m]=e[m];b=this.keyMeshing(b,a,k,l)}if(0<
h)for(this.process(l,a),k=0;k<h;k++)c[g*f+k]^=a[k];return c.buffer}function ia(b,c,a){a=new Uint8Array(a||this.iv);c=t(c);for(var d=a.length,e=new Uint8Array(d),f=this.shiftBits>>3,g=new Uint8Array(f),h=c.length,l=h%f,h=(h-l)/f,k=this.keySchedule(b),m=0;m<h;m++){for(var n=0;n<d;n++)e[n]=a[n];this.process(k,a);for(n=0;n<f;n++)g[n]=a[n];for(n=0;n<f;n++)c[m*f+n]^=a[n];for(n=0;n<d-f;n++)a[n]=e[f+n];for(n=0;n<f;n++)a[d-f+n]=g[n];b=this.keyMeshing(b,a,m,k)}if(0<l)for(this.process(k,a),m=0;m<l;m++)c[h*f+
m]^=a[m];return c.buffer}function ja(b,c,a){a=new Uint8Array(a||this.iv);c=t(c);var d=this.blockSize,e=new Int8Array(d),f=c.length,g=f%d,f=(f-g)/d,h=this.keySchedule(b),l=new Int32Array(a.buffer);this.process(h,a);for(var k=0;k<f;k++){l[0]=l[0]+16843009&4294967295;var m=N(l[1])+16843012;l[1]=w(4294967296>m?m:m-4294967295);for(m=0;m<d;m++)e[m]=a[m];this.process(h,l);for(m=0;m<d;m++)c[k*d+m]^=a[m];for(m=0;m<d;m++)a[m]=e[m];b=this.keyMeshing(b,a,k,h)}if(0<g)for(l[0]=l[0]+16843009&4294967295,m=N(l[1])+
16843012,l[1]=w(4294967296>m?m:m-4294967295),this.process(h,l),k=0;k<g;k++)c[f*d+k]^=a[k];return c.buffer}function L(b,c,a){c=t(c);var d=this.blockSize,e=this.shiftBits>>3,f=c.length,g=f%e,f=(f-g)/e,h=new Uint8Array(d),l=new Int32Array(d);b=this.keySchedule(b);h.set(a||this.iv);for(a=0;a<f;a++){for(var k=0;k<d;k++)l[k]=h[k];this.process(b,h);for(k=0;k<e;k++)c[e*a+k]^=h[k];for(k=0;k<d;k++)h[k]=l[k];for(k=d-1;0<=a;--a)if(254<h[k])h[k]-=254;else{h[k]++;break}}if(0<g)for(this.process(b,h),k=0;k<g;k++)c[e*
f+k]^=h[k];return c.buffer}function T(b,c,a){a=new Uint8Array(a||this.iv);var d=this.blockSize,e=a.length;c=this.pad(s(c));for(var f=this.keySchedule(b),g=0,h=c.length/d;g<h;g++){for(var l=0;l<d;l++)a[l]^=c[g*d+l];this.process(f,a);for(l=0;l<d;l++)c[g*d+l]=a[l];if(e!==d){for(l=0;l<e-d;l++)a[l]=a[d+l];for(l=0;l<d;l++)a[l+e-d]=c[g*d+l]}b=this.keyMeshing(b,a,g,f)}return c.buffer}function ka(b,c,a){a=new Uint8Array(a||this.iv);var d=this.blockSize,e=a.length;c=t(c);for(var f=new Uint8Array(d),g=this.keySchedule(b,
1),h=0,l=c.length/d;h<l;h++){for(var k=0;k<d;k++)f[k]=c[h*d+k];this.process(g,c,h*d,1);for(k=0;k<d;k++)c[h*d+k]^=a[k];if(e!==d)for(k=0;k<e-d;k++)a[k]=a[d+k];for(k=0;k<d;k++)a[k+e-d]=f[k];b=this.keyMeshing(b,a,h,g,1)}return this.unpad(c).buffer}function y(){var b=new Uint8Array(this.keySize);H(b);return b.buffer}function la(b,c,a){a=U.call(this,s(a));for(var d=this.blockSize,e=a.length/d,f=this.sBox,g=new Int32Array(c.buffer),h=0;h<e;h++){for(var l=0;l<d;l++)c[l]^=a[h*d+l];for(l=0;16>l;l++)K(f,g,b[l])}}
function V(b){for(var c=0,a=b.length,d=a-1;0<=d;--d){var e=b[d]>>>7;b[d]=b[d]<<1&255|c;c=e}0!==c&&(16===a?b[15]^=135:b[7]^=27)}function ma(b,c,a){var d=this.blockSize,e=s(a),f=new Uint8Array(d);this.process(b,f);V(f);0!==a.byteLength%d&&(e=W.call(this,s(a)),V(f));a=0;for(var g=e.length/d;a<g;a++){for(var h=0;h<d;h++)c[h]^=e[a*d+h];if(a===g-1)for(h=0;h<d;h++)c[h]^=f[h];this.process(b,c)}}function z(b,c,a){b=this.keySchedule(b);a=new Uint8Array(a||this.iv);var d=Math.ceil(this.macLength>>3)||this.blockSize>>
1;this.processMAC(b,a,c);c=new Uint8Array(d);c.set(new Uint8Array(a.buffer,0,d));return c.buffer}function A(b,c,a,d){b=new Uint8Array(z.call(this,b,a,d));c=s(c);if(b.length!==c.length)return!1;a=0;for(d=b.length;a<d;a++)if(b[a]!==c[a])return!1;return!0}function na(b,c){var a=this.keySize,d=a+(this.blockSize>>1);if(!this.ukm)throw new p("UKM must be defined");var e=new Uint8Array(this.ukm),e=z.call(this,b,c,e),f=x.call(this,b,c),d=new Uint8Array(d);d.set(new Uint8Array(f),0);d.set(new Uint8Array(e),
a);return d.buffer}function oa(b,c){var a=this.blockSize,d=this.keySize,e=d+(a>>1),f=q(c);if(f.byteLength!==e)throw new p("Wrapping key size must be "+e+" bytes");if(!this.ukm)throw new p("UKM must be defined");var e=new Uint8Array(this.ukm),g=new Uint8Array(f,0,d),a=new Uint8Array(f,d,a>>1),d=F.call(this,b,g);if(!A.call(this,b,a,d,e))throw new p("Error verify MAC of wrapping key");return d}function X(b,c){for(var a=this.blockSize,d=new Int32Array(q(b)),e=[],f=0;f<a;f++){e[f]=[];for(var g=0;8>g;g++)e[f][g]=
c[f]>>>g&1}for(f=0;f<a;f++){for(var h=new Int32Array(2),g=0;8>g;g++)e[f][g]?h[0]=h[0]+d[g]&4294967295:h[1]=h[1]+d[g]&4294967295;g=new Uint8Array(h.buffer);d=new Int32Array(S.call(this,d,d,g))}return d}function pa(b,c){var a=this.keySize,d=a+(this.blockSize>>1);if(!this.ukm)throw new p("UKM must be defined");var e=new Uint8Array(this.ukm),f=X.call(this,b,e),e=z.call(this,f,c,e),f=x.call(this,f,c),d=new Uint8Array(d);d.set(new Uint8Array(f),0);d.set(new Uint8Array(e),a);return d.buffer}function qa(b,
c){var a=this.blockSize,d=this.keySize,e=d+(a>>1),f=q(c);if(f.byteLength!==e)throw new p("Wrapping key size must be "+e+" bytes");if(!this.ukm)throw new p("UKM must be defined");var e=new Uint8Array(this.ukm),g=new Uint8Array(f,0,d),a=new Uint8Array(f,d,a>>1),d=X.call(this,b,e),g=F.call(this,d,g);if(!A.call(this,d,a,g,e))throw new p("Error verify MAC of wrapping key");return g}function Y(b){var c=this.blockSize>>1,a=this.keySize,d=q(b);if(34!==(new Uint8Array(d,0,1))[0])throw new p("Invalid magic number");
var e=(new Uint8Array(d,1,1))[0];b=new Uint8Array(d,2,c);for(var f=new Uint8Array(a),g=0;g<e;g++)for(var h=new Uint8Array(d,2+c+a*g,a),l=0;l<a;l++)f[l]^=h[l];c=new Uint8Array(a);a=A.call(this,f,b,c);if(!a)for(d=["E-A","E-B","E-C","E-D","E-SC"],g=0,e=d.length;g<e&&!(this.sBox=u[d[g]],a=A.call(this,f,b,c));g++);if(!a)throw new p("Invalid main key MAC");return f.buffer}function ra(b,c){var a=this.blockSize>>1,d=this.keySize,e=q(b),f=q(c);e.byteLength!==d&&(e=Y.call(this,e));var g=x.call(this,e,f),e=
z.call(this,e,f),a=new Uint8Array(a+d);a.set(new Uint8Array(g),0);a.set(new Uint8Array(e),d);return a.buffer}function sa(b,c){var a=this.blockSize>>1,d=this.keySize,e=q(b),f=q(c);e.byteLength!==d&&(e=Y.call(this,e));var g=new Uint8Array(f,0,d),a=new Uint8Array(f,d,a),g=F.call(this,e,g);if(!A.call(this,e,a,g))throw new p("Invalid key MAC");return g}function ta(){var b=y.call(this),c=void 0,a=this.blockSize>>1,d=this.keySize,e=8,b=new Uint8Array(q(b));if(b.byteLength!==d)throw new p("Wrong cleartext size "+
b.byteLength+" bytes");if(c=c||this.ukm)if(c=new Uint8Array(q(c)),0<c.byteLength&&0===c.byteLength%d)e=c.byteLength/d+1;else throw new p("Wrong rand size "+c.byteLength+" bytes");else H(c=new Uint8Array((e-1)*d));var f=new Uint8Array(e*d+a+2),g=f.buffer,h=new Uint8Array(d),h=z.call(this,b,h);f[0]=34;f[1]=e;f.set(new Uint8Array(h),2);f.set(c,d+a+2);for(c=1;c<e;c++)for(var h=new Uint8Array(g,2+a+d*c),l=0;l<d;l++)b[l]^=h[l];f.set(b,a+2);return f.buffer}function Z(b,c,a,d){d/=4;b=new Int32Array(q(b));
c=new Int32Array(q(c));var e=new Int32Array(d);if(a)for(a=0;a<d;a++)e[a]=c[a]+b[a]&4294967295;else for(a=0;a<d;a++)e[a]=c[a]-b[a]&4294967295;return e.buffer}function ua(b,c){return Z(b,c,"VN"===this.procreator,this.keySize)}function va(b,c){return Z(b,c,"VN"!==this.procreator,this.keySize)}function wa(b,c,a,d,e){0===(a+1)*this.blockSize%1024&&(b=F.call(this,b,xa),c.set(new Uint8Array(x.call(this,b,c))),d.set(this.keySchedule(b,e)));return b}function M(b){return b}function G(b){return new Uint8Array(b)}
function ya(b){var c=b.byteLength,a=this.blockSize,d=a-c%a,a=Math.ceil((c+1)/a)*a,e=new Uint8Array(a);e.set(b);for(b=c;b<a;b++)e[b]=d;return e}function za(b){var c=b.byteLength,a=b[c-1],c=c-a;if(a>this.blockSize)throw p("Invalid padding");a=new Uint8Array(c);0<c&&a.set(new Uint8Array(b.buffer,0,c));return a}function U(b){var c=b.byteLength,a=this.blockSize,a=Math.ceil(c/a)*a,d=new Uint8Array(a);d.set(b);for(b=c;b<a;b++)d[b]=0;return d}function W(b){var c=b.byteLength,a=this.blockSize,a=Math.ceil((c+
1)/a)*a,d=new Uint8Array(a);d.set(b);d[c]=1;for(b=c+1;b<a;b++)d[b]=0;return d}function Aa(b){for(var c=b.byteLength;1<c&&0===b[c-1];)c--;if(1!==b[c-1])throw p("Invalid padding");c--;var a=new Uint8Array(c);0<c&&a.set(new Uint8Array(b.buffer,0,c));return a}function Ba(b){var c=b.byteLength,a=this.blockSize,d=a-c%a,a=Math.ceil(c/a)*a,a=new Uint8Array(a),c=new Uint8Array(a.buffer,c,d);a.set(b);H(c);return a}var r=this,$=r.crypto||r.msCrypto,I=r.ArrayBuffer,B=r.SyntaxError||r.Error,p=r.DataError||r.Error,
C=r.NotSupportedError||r.Error,Ca=function(){var b=new I(2);(new DataView(b)).setInt16(0,256,!0);return 256===(new Int16Array(b))[0]}(),Da=new Uint8Array([0,0,0,0,0,0,0,0]),u={"E-TEST":[4,2,15,5,9,1,0,8,14,3,11,12,13,7,10,6,12,9,15,14,8,1,3,10,2,7,4,13,6,0,11,5,13,8,14,12,7,3,9,10,1,5,2,4,6,15,0,11,14,9,11,2,5,15,7,1,0,13,12,6,10,4,3,8,3,14,5,9,6,8,0,13,10,11,7,12,2,1,15,4,8,15,6,11,1,9,12,5,13,3,7,10,0,14,2,4,9,11,12,0,3,6,7,5,4,8,14,15,1,10,2,13,12,6,5,2,11,0,9,13,3,14,7,10,15,4,1,8],"E-A":[9,6,
3,2,8,11,1,7,10,4,14,15,12,0,13,5,3,7,14,9,8,10,15,0,5,2,6,12,11,4,13,1,14,4,6,2,11,3,13,8,12,15,5,10,0,7,1,9,14,7,10,12,13,1,3,9,0,2,11,4,15,8,5,6,11,5,1,9,8,13,15,0,14,4,2,3,12,7,10,6,3,10,13,12,1,2,0,11,7,5,9,4,8,15,14,6,1,13,2,9,7,10,6,0,8,12,4,5,15,3,11,14,11,10,15,5,0,12,14,8,6,2,3,9,1,7,13,4],"E-B":[8,4,11,1,3,5,0,9,2,14,10,12,13,6,7,15,0,1,2,10,4,13,5,12,9,7,3,15,11,8,6,14,14,12,0,10,9,2,13,11,7,5,8,15,3,6,1,4,7,5,0,13,11,6,1,2,3,10,12,15,4,14,9,8,2,7,12,15,9,5,10,11,1,4,0,13,6,8,14,3,8,3,
2,6,4,13,14,11,12,1,7,15,10,0,9,5,5,2,10,11,9,1,12,3,7,4,13,0,6,15,8,14,0,4,11,14,8,3,7,1,10,2,9,6,15,13,5,12],"E-C":[1,11,12,2,9,13,0,15,4,5,8,14,10,7,6,3,0,1,7,13,11,4,5,2,8,14,15,12,9,10,6,3,8,2,5,0,4,9,15,10,3,7,12,13,6,14,1,11,3,6,0,1,5,13,10,8,11,2,9,7,14,15,12,4,8,13,11,0,4,5,1,2,9,3,12,14,6,15,10,7,12,9,11,1,8,14,2,4,7,3,6,5,10,0,15,13,10,9,6,8,13,14,2,0,15,3,5,11,4,1,12,7,7,4,0,5,10,2,15,14,12,6,1,11,13,9,3,8],"E-D":[15,12,2,10,6,4,5,0,7,9,14,13,1,11,8,3,11,6,3,4,12,15,14,2,7,13,8,0,5,10,
9,1,1,12,11,0,15,14,6,5,10,13,4,8,9,3,7,2,1,5,14,12,10,7,0,13,6,2,11,4,9,3,15,8,0,12,8,9,13,2,10,11,7,3,6,5,4,14,15,1,8,0,15,3,2,5,14,11,1,10,4,7,12,9,13,6,3,0,6,15,1,14,9,2,13,8,12,4,11,10,5,7,1,10,6,8,15,11,0,4,12,3,5,9,7,13,2,14],"E-SC":[3,6,1,0,5,7,13,9,4,11,8,12,14,15,2,10,7,1,5,2,8,11,9,12,13,0,3,10,15,14,4,6,15,1,4,6,12,8,9,2,14,3,7,10,11,13,5,0,3,4,15,12,5,9,14,0,6,8,7,10,1,11,13,2,6,9,0,7,11,8,4,12,2,14,10,15,1,13,5,3,6,1,2,15,0,11,9,12,7,13,10,5,8,4,14,3,0,2,14,12,9,1,4,7,3,15,6,8,10,13,
11,5,5,2,11,8,4,12,7,1,10,6,14,0,9,3,13,15],"E-Z":[12,4,6,2,10,5,11,9,14,8,13,7,0,3,15,1,6,8,2,3,9,10,5,12,1,14,4,7,11,13,0,15,11,3,5,8,2,15,10,13,14,1,7,4,12,9,6,0,12,8,2,1,13,4,15,6,7,0,10,5,3,14,9,11,7,15,5,10,8,1,6,13,0,9,3,14,11,4,2,12,5,13,15,6,9,2,12,10,11,7,8,1,4,3,14,0,8,14,2,5,6,9,1,12,15,4,11,0,13,10,3,7,1,7,14,13,0,5,8,3,4,15,10,6,9,12,11,2],"D-TEST":[4,10,9,2,13,8,0,14,6,11,1,12,7,15,5,3,14,11,4,12,6,13,15,10,2,3,8,1,0,7,5,9,5,8,1,13,10,3,4,2,14,15,12,7,6,0,9,11,7,13,10,1,0,8,9,15,14,
4,6,12,11,2,5,3,6,12,7,1,5,15,13,8,4,10,9,14,0,3,11,2,4,11,10,0,7,2,1,13,3,6,8,5,9,12,15,14,13,11,4,1,3,15,5,9,0,10,14,7,6,8,2,12,1,15,13,0,5,7,10,4,9,2,3,14,6,11,8,12],"D-A":[10,4,5,6,8,1,3,7,13,12,14,0,9,2,11,15,5,15,4,0,2,13,11,9,1,7,6,3,12,14,10,8,7,15,12,14,9,4,1,0,3,11,5,2,6,10,8,13,4,10,7,12,0,15,2,8,14,1,6,5,13,11,9,3,7,6,4,11,9,12,2,10,1,8,0,14,15,13,3,5,7,6,2,4,13,9,15,0,10,1,5,11,8,14,12,3,13,14,4,1,7,0,5,10,3,12,8,15,6,2,9,11,1,3,10,9,5,11,4,15,8,6,7,14,13,0,2,12],"D-SC":[11,13,7,0,5,
4,1,15,9,14,6,10,3,12,8,2,1,2,7,9,13,11,15,8,14,12,4,0,5,6,10,3,5,1,13,3,15,6,12,7,9,8,11,2,4,14,0,10,13,1,11,4,9,12,14,0,7,5,8,15,6,2,10,3,2,13,10,15,9,11,3,7,8,12,5,14,6,0,1,4,0,4,6,12,5,3,8,13,10,11,15,2,1,9,7,14,1,3,12,8,10,6,11,0,2,14,7,9,15,4,5,13,10,11,6,0,1,3,4,7,14,13,5,15,8,2,9,12]},xa=new Uint8Array([105,0,114,34,100,201,4,35,141,58,219,150,70,233,42,196,24,254,172,148,0,237,7,18,192,134,220,194,239,76,169,43]),Ea=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),P=function(){for(var b=
[1,16,32,133,148,192,194,251],c=[],a=0;8>a;a++){c[a]=[];for(var d=0;256>d;d++){for(var e=c[a],f=d,g=b[a],h=d,l=0,k=void 0,m=void 0,k=0;8>k;k++)h&1&&(l^=g),m=g&128,g=g<<1&255,m&&(g^=195),h>>=1;e[f]=l&255}}return c}(),Q=[4,2,3,1,6,5,0,7,0,5,6,1,3,2,4,0],J=[252,238,221,17,207,110,49,22,251,196,250,218,35,197,4,77,233,119,240,219,147,46,153,186,23,54,241,187,20,205,95,193,249,24,101,90,226,92,239,33,129,28,60,66,139,1,142,79,5,132,2,174,227,106,143,160,6,11,237,152,127,212,211,31,235,52,44,81,234,200,
72,171,242,42,104,162,253,58,206,204,181,112,14,86,8,12,118,18,191,114,19,71,156,183,93,135,21,161,150,41,16,123,154,199,243,145,120,111,157,158,178,177,50,117,25,61,255,53,138,126,109,84,198,128,195,189,13,87,223,245,36,169,62,168,67,201,215,121,214,246,124,34,185,3,224,15,236,222,122,148,176,188,220,232,40,80,78,51,10,74,167,151,96,115,30,0,98,68,26,184,56,130,100,159,38,65,173,69,70,146,39,94,85,47,140,163,165,125,105,213,149,59,7,88,179,64,134,172,29,247,48,55,107,228,136,217,231,137,225,27,131,
73,76,63,248,254,141,83,170,144,202,216,133,97,32,113,103,164,45,43,9,91,203,155,37,208,190,229,108,82,89,166,116,210,230,244,180,192,209,102,175,194,57,75,99,182],ca=function(){for(var b=[],c=0,a=J.length;c<a;c++)b[J[c]]=c;return b}(),Fa=function(){var b=new Uint8Array([217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,
84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,
186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173]);return function(c){c=new Uint8Array(q(c));for(var a=Math.min(c.length,128),d=this.effectiveLength,e=Math.floor((d+7)/8),d=255%Math.pow(2,8+d-8*e),f=new Uint8Array(128),g=new Uint16Array(f.buffer),h=0;h<a;h++)f[h]=c[h];for(h=a;128>h;h++)f[h]=b[(f[h-1]+f[h-a])%256];f[128-e]=b[f[128-e]&d];for(h=127-e;0<=h;--h)f[h]=b[f[h+1]^
f[h+e]];return g}}(),Ga=function(){function b(a){if(h){var b=f[a],c=g[a];f[a]=(b>>>c|b<<16-c)&65535;f[a]=f[a]-d[e]-(f[(a+3)%4]&f[(a+2)%4])-(~f[(a+3)%4]&f[(a+1)%4]);--e}else f[a]=f[a]+d[e]+(f[(a+3)%4]&f[(a+2)%4])+(~f[(a+3)%4]&f[(a+1)%4]),e+=1,b=f[a],c=g[a],f[a]=(b<<c|b>>>16-c)&65535}function c(a){f[a]=h?f[a]-d[f[(a+3)%4]&63]:f[a]+d[f[(a+3)%4]&63]}function a(a,b){b=b||1;for(var c=0;c<b;c++)if(h)for(var d=3;0<=d;--d)a(d);else for(d=0;4>d;d++)a(d)}var d,e,f=new Uint16Array(4),g=new Uint16Array([1,2,3,
5]),h;return function(g,k,m,n){h=n;f=new Uint16Array(k.buffer,m||k.byteOffset,4);d=g;e=n?63:0;a(b,5);a(c);a(b,6);a(c);a(b,5)}}();return function(b){if(!Ca)throw new C("Big endian platform not supported");b=b||{};this.keySize=32;this.blockLength=b.length||64;this.blockSize=this.blockLength>>3;this.name=(b.name||(1===b.version?"RC2":1989===b.version?"GOST 28147":"GOST R 34.12"))+(4<b.version?"-"+(b.version||1989)%100:"")+"-"+(64===this.blockLength?"":this.blockLength+"-")+("MAC"===b.mode?"MAC-"+(b.macLength||
this.blockLength>>1):"KW"===b.mode||b.keyWrapping?("NO"!==(b.keyWrapping||"NO")?b.keyWrapping:"")+"KW":(b.block||"ECB")+(("CFB"===b.block||"OFB"===b.block||"CTR"===b.block&&2015===b.version)&&b.shiftBits&&b.shiftBits!==this.blockLength?"-"+b.shiftBits:"")+(b.padding?"-"+(b.padding||("CTR"===b.block||"CFB"===b.block||"OFB"===b.block?"NO":"ZERO"))+"PADDING":"")+("NO"!==(b.keyMeshing||"NO")?"-CPKEYMESHING":""))+(b.procreator?"/"+b.procreator:"")+("string"===typeof b.sBox?"/"+b.sBox:"");this.procreator=
b.procreator;switch(b.version||1989){case 1:this.process=Ga;this.keySchedule=Fa;this.blockLength=64;this.effectiveLength=b.length||32;this.keySize=8*Math.ceil(this.effectiveLength/8);this.blockSize=this.blockLength>>3;break;case 2015:this.version=2015;if(64===this.blockLength)this.process=ea,this.keySchedule=ga;else if(128===this.blockLength)this.process=ba,this.keySchedule=aa;else throw new p("Invalid block length");this.processMAC=ma;break;case 1989:this.version=1989;this.process=da;this.processMAC=
la;this.keySchedule=fa;if(64!==this.blockLength)throw new p("Invalid block length");break;default:throw new C("Algorithm version "+b.version+" not supported");}switch(b.mode||b.keyWrapping&&"KW"||"ES"){case "ES":switch(b.block||"ECB"){case "ECB":this.encrypt=x;this.decrypt=F;break;case "CTR":1989===this.version?this.decrypt=this.encrypt=ja:(this.decrypt=this.encrypt=L,this.shiftBits=b.shiftBits||this.blockLength);break;case "CBC":this.encrypt=T;this.decrypt=ka;break;case "CFB":this.encrypt=S;this.decrypt=
ha;this.shiftBits=b.shiftBits||this.blockLength;break;case "OFB":this.decrypt=this.encrypt=ia;this.shiftBits=b.shiftBits||this.blockLength;break;default:throw new C("Block mode "+b.block+" not supported");}switch(b.keyMeshing){case "CP":this.keyMeshing=wa;break;default:this.keyMeshing=M}if(this.encrypt===x||this.encrypt===T)switch(b.padding){case "PKCS5P":this.pad=ya;this.unpad=za;break;case "RANDOM":this.pad=Ba;this.unpad=G;break;case "BIT":this.pad=W;this.unpad=Aa;break;default:this.pad=U,this.unpad=
G}else this.unpad=this.pad=G;this.generateKey=y;break;case "MAC":this.sign=z;this.verify=A;this.generateKey=y;this.macLength=b.macLength||this.blockLength>>1;this.unpad=this.pad=G;this.keyMeshing=M;break;case "KW":this.unpad=this.pad=G;this.keyMeshing=M;switch(b.keyWrapping){case "CP":this.wrapKey=pa;this.unwrapKey=qa;this.generateKey=y;this.shiftBits=b.shiftBits||this.blockLength;break;case "SC":this.wrapKey=ra;this.unwrapKey=sa;this.generateKey=ta;break;default:this.wrapKey=na,this.unwrapKey=oa,
this.generateKey=y}break;case "MASK":this.wrapKey=ua;this.unwrapKey=va;this.generateKey=y;break;default:throw new C("Mode "+b.mode+" not supported");}var c=b.sBox;if(!c)c=2015===this.version?u["E-Z"]:"SC"===this.procreator?u["E-SC"]:u["E-A"];else if("string"===typeof c){if(c=c.toUpperCase(),c=u[c],!c)throw new B("Unknown sBox name: "+b.sBox);}else if(!c.length||c.length!==u["E-Z"].length)throw new B("Length of sBox must be "+u["E-Z"].length);this.sBox=c;if(b.iv){this.iv=new Uint8Array(b.iv);if(this.iv.byteLength!==
this.blockSize&&1989===this.version)throw new B("Length of iv must be "+this.blockLength+" bits");if(this.iv.byteLength!==this.blockSize>>1&&this.encrypt===L)throw new B("Length of iv must be "+this.blockLength>>NaN);if(0!==this.iv.byteLength%this.blockSize&&this.encrypt!==L)throw new B("Length of iv must be a multiple of "+this.blockLength+" bits");}else this.iv=128===this.blockLength?Ea:Da;if(b.ukm&&(this.ukm=new Uint8Array(b.ukm),8*this.ukm.byteLength!==this.blockLength))throw new B("Length of ukm must be "+
this.blockLength+" bits");}});
