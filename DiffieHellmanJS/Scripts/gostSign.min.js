/*
 2014-2016, Rudolf Nickolaev. All rights reserved.
*/
(function(K,F){"function"===typeof define&&define.amd?define(["gostRandom","gostDigest"],F):"object"===typeof exports?module.exports=F(require("gostRandom"),require("gostDigest")):K.GostSign=F(K.GostRandom,K.GostDigest)})(this,function(K,F){function B(a,b,c,d,e,f,g){var h=c&16383;for(c>>=14;0<=--g;){var k=a[b]&16383,l=a[b++]>>14,n=c*k+l*h,k=h*k+((n&16383)<<14)+d[e]+f;f=(k>>28)+(n>>14)+c*l;d[e++]=k&268435455}return f}function n(a){a=Array(Math.ceil(a));a.s=0;a.t=0;return a}function G(a,b){for(var c=
a.t-1;0<=c;--c)b[c]=a[c];b.t=a.t;b.s=a.s;return b}function ua(a,b){a.t=1;a.s=0>b?-1:0;0<b?a[0]=b:-1>b?a[0]=b+268435456:a.t=0;return a}function C(a){var b=n(1);ua(b,a);return b}function u(a){for(var b=a.s&268435455;0<a.t&&a[a.t-1]===b;)--a.t;return a}function p(a,b,c){for(var d=0,e=0,f=Math.min(b.t,a.t);d<f;)e+=a[d]-b[d],c[d++]=e&268435455,e>>=28;if(b.t<a.t){for(e-=b.s;d<a.t;)e+=a[d],c[d++]=e&268435455,e>>=28;e+=a.s}else{for(e+=a.s;d<b.t;)e-=b[d],c[d++]=e&268435455,e>>=28;e-=b.s}c.s=0>e?-1:0;-1>e?
c[d++]=268435456+e:0<e&&(c[d++]=e);c.t=d;return u(c)}function fa(a,b){return p(a,b,n(a.t))}function L(a,b,c){for(var d=0,e=0,f=Math.min(b.t,a.t);d<f;)e+=a[d]+b[d],c[d++]=e&268435455,e>>=28;if(b.t<a.t){for(e+=b.s;d<a.t;)e+=a[d],c[d++]=e&268435455,e>>=28;e+=a.s}else{for(e+=a.s;d<b.t;)e+=b[d],c[d++]=e&268435455,e>>=28;e+=b.s}c.s=0>e?-1:0;0<e?c[d++]=e:-1>e&&(c[d++]=268435456+e);c.t=d;return u(c)}function M(a){if(0>a.s){var b=n(a.t);a=p(t,a,b)}return a}function s(a,b){var c=a.s-b.s;if(0!==c)return c;var d=
a.t,c=d-b.t;if(0!==c)return 0>a.s?-c:c;for(;0<=--d;)if(0!==(c=a[d]-b[d]))return c;return 0}function ga(a){var b=1,c;0!==(c=a>>>16)&&(a=c,b+=16);0!==(c=a>>8)&&(a=c,b+=8);0!==(c=a>>4)&&(a=c,b+=4);0!==(c=a>>2)&&(a=c,b+=2);0!==a>>1&&(b+=1);return b}function U(a,b,c){var d;for(d=a.t-1;0<=d;--d)c[d+b]=a[d];for(d=b-1;0<=d;--d)c[d]=0;c.t=a.t+b;c.s=a.s;return c}function Y(a,b,c){for(var d=b;d<a.t;++d)c[d-b]=a[d];c.t=Math.max(a.t-b,0);c.s=a.s;return c}function ha(a,b,c){var d=b%28,e=28-d,f=(1<<e)-1;b=Math.floor(b/
28);var g=a.s<<d&268435455,h;for(h=a.t-1;0<=h;--h)c[h+b+1]=a[h]>>e|g,g=(a[h]&f)<<d;for(h=b-1;0<=h;--h)c[h]=0;c[b]=g;c.t=a.t+b+1;c.s=a.s;return u(c)}function H(a,b,c){c.s=a.s;var d=Math.floor(b/28);if(d>=a.t)c.t=0;else{b%=28;var e=28-b,f=(1<<b)-1;c[0]=a[d]>>b;for(var g=d+1;g<a.t;++g)c[g-d-1]|=(a[g]&f)<<e,c[g-d]=a[g]>>b;0<b&&(c[a.t-d-1]|=(a.s&f)<<e);c.t=a.t-d;return u(c)}}function I(a){return 0>=a.t?0:28*(a.t-1)+ga(a[a.t-1]^a.s&268435455)}function Z(a,b,c){var d=M(a),e=M(b),f=d.t;for(c.t=f+e.t;0<=--f;)c[f]=
0;for(f=0;f<e.t;++f)c[f+d.t]=B(d,0,e[f],c,f,0,d.t);c.s=0;a.s!==b.s&&p(t,c,c);return u(c)}function v(a,b){return Z(a,b,n(a.t+b.t))}function $(a,b){for(var c=M(a),d=b.t=2*c.t;0<=--d;)b[d]=0;for(d=0;d<c.t-1;++d){var e=B(c,d,c[d],b,2*d,0,1);(b[d+c.t]+=B(c,d+1,2*c[d],b,2*d+1,e,c.t-d-1))>=c.DV&&(b[d+c.t]-=c.DV,b[d+c.t+1]=1)}0<b.t&&(b[b.t-1]+=B(c,d,c[d],b,2*d,0,1));b.s=0;return u(b)}function ia(a,b,c,d){var e=M(b);if(0>=e.t)throw new Ea("Division by zero");var f=M(a);if(f.t<e.t)return c&&ua(c,0),d&&G(a,
d),c;d||(d=n(b.t));var g=n(b.t),h=a.s,k=b.s,l=28-ga(e[e.t-1]);0<l?(ha(e,l,g),ha(f,l,d)):(G(e,g),G(f,d));e=g.t;f=g[e-1];if(0===f)return c;var m=16777216*f+(1<e?g[e-2]>>4:0),q=Fa/m,m=16777216/m,N=d.t,r=N-e;a=c?c:n(Math.max(a.t-b.t,1));U(g,r,a);0<=s(d,a)&&(d[d.t++]=1,p(d,a,d));U(R,e,a);for(p(a,g,g);g.t<e;)g[g.t++]=0;for(;0<=--r;)if(b=d[--N]===f?268435455:Math.floor(d[N]*q+(d[N-1]+16)*m),(d[N]+=B(g,0,b,d,r,0,e))<b)for(U(g,r,a),p(d,a,d);d[N]<--b;)p(d,a,d);c&&(Y(d,e,c),h!==k&&p(t,c,c));d.t=e;u(d);0<l&&
H(d,l,d);0>h&&p(t,d,d);return c}function va(a,b,c){ia(M(a),b,null,c);0>a.s&&0<s(c,t)&&p(b,c,c);return c}function m(a,b){return va(a,b,n(b.t))}function y(a){return 0===(0<a.t?a[0]&1:a.s)}function z(a){return 0===s(a,t)}function S(a){return 0>a.s?-1:0>=a.t||1===a.t&&0>=a[0]?0:1}function aa(a,b){var c=y(b);if(y(a)&&c||0===S(b))return t;for(var d=G(b,n(b.t)),e=G(a,n(a.t)),f=C(1),g=C(0),h=C(0),k=C(1);0!==S(d);){for(;y(d);)H(d,1,d),c?(y(f)&&y(g)||(L(f,a,f),p(g,b,g)),H(f,1,f)):y(g)||p(g,b,g),H(g,1,g);for(;y(e);)H(e,
1,e),c?(y(h)&&y(k)||(L(h,a,h),p(k,b,k)),H(h,1,h)):y(k)||p(k,b,k),H(k,1,k);0<=s(d,e)?(p(d,e,d),c&&p(f,h,f),p(g,k,g)):(p(e,d,e),c&&p(h,f,h),p(k,g,k))}if(0!==s(e,R))return t;if(0<=s(k,b))return subtract(k,b);if(0>S(k))L(k,b,k);else return k;return 0>S(k)?L(k,b,n(k.t)):k}function V(a,b){var c=Math.floor(b/28);return c>=a.t?0!==a.s:0!==(a[c]&1<<b%28)}function ja(a,b){for(var c in b)a.prototype[c]=b[c]}function ka(a){this.r2=n(2*a.t);this.q3=n(2*a.t);U(R,2*a.t,this.r2);var b=this.r2;this.mu=ia(b,a,n(Math.max(b.t-
a.t,1)),null);this.m=a}function ba(a,b,c){var d=I(b),e,f=C(1),g;if(0>=d)return f;e=18>d?1:48>d?3:144>d?4:768>d?5:6;g=8>d?new wa(c):y(c)?new ka(c):new xa(c);var h=[],k=3,l=e-1,m=(1<<e)-1;h[1]=g.convert(a);if(1<e)for(d=n(2*c.t),g.sqrTo(h[1],d);k<=m;)h[k]=n(2*c.t),g.mulTo(d,h[k-2],h[k]),k+=2;a=b.t-1;for(var p=!0,q=n(2*c.t),d=ga(b[a])-1;0<=a;){d>=l?c=b[a]>>d-l&m:(c=(b[a]&(1<<d+1)-1)<<l-d,0<a&&(c|=b[a-1]>>28+d-l));for(k=e;0==(c&1);)c>>=1,--k;0>(d-=k)&&(d+=28,--a);if(p)G(h[c],f),p=!1;else{for(;1<k;)g.sqrTo(f,
q),g.sqrTo(q,f),k-=2;0<k?g.sqrTo(f,q):(k=f,f=q,q=k);g.mulTo(q,h[c],f)}for(;0<=a&&0==(b[a]&1<<d);)g.sqrTo(f,q),k=f,f=q,q=k,0>--d&&(d=27,--a)}return g.revert(f)}function w(a,b){a.r.reduce(b);b.q=a.q;b.r=a.r;return b}function ca(a,b){b.q=a.q;b.r=a.r;return b}function ya(a,b){var c=L(a,b,n(a.t));0<s(c,a.q)&&p(c,a.q,c);return ca(a,c)}function D(a,b){var c=fa(a,b);0>c.s&&L(a.q,c,c);return ca(a,c)}function l(a,b){return w(a,v(a,b))}function O(a){return w(a,$(a,n(2*a.t)))}function T(a,b){var c=n(a.t);0>b?
H(a,-b,c):ha(a,b,c);return w(a,c)}function za(a){return ca(a,aa(a,a.q))}function P(a,b,c,d){return{curve:a,x:b,y:c,z:d||w(a,R)}}function da(a){a.zinv||(a.zinv=za(a.z));return l(a.x,a.zinv)}function Aa(a){a.zinv||(a.zinv=za(a.z));return l(a.y,a.zinv)}function W(a){return a.x||a.y?z(a.z)&&!z(a.y):!0}function X(a,b){if(W(a))return b;if(W(b))return a;var c=D(l(b.y,a.z),l(a.y,b.z)),d=D(l(b.x,a.z),l(a.x,b.z));if(z(d))return z(c)?la(a):a.curve.infinity;var e=a.x,f=a.y,g=O(d),h=l(g,d),e=l(e,g),g=l(O(c),a.z),
d=l(D(l(D(g,T(e,1)),b.z),h),d),c=ya(l(D(D(l(l(e,ea),c),l(f,h)),l(g,c)),b.z),l(c,h)),h=l(l(h,a.z),b.z);return P(a.curve,d,c,h)}function la(a){if(W(a))return a;if(0===S(a.y))return a.curve.infinity;var b=a.x,c=a.y,d=l(c,a.z),e=l(d,c),c=a.curve.a,f=l(O(b),ea);z(c)||(f=ya(f,l(O(a.z),c)));c=l(T(D(O(f),l(T(b,3),e)),1),d);b=D(l(T(D(l(l(f,ea),b),T(e,1)),2),e),l(O(f),f));d=T(l(O(d),d),3);return P(a.curve,c,b,d)}function ma(a,b){if(W(a))return a;if(0===S(b))return a.curve.infinity;var c=v(b,ea),d;d=a.curve;
var e=a.x,f;f=a.y;f=ca(f,fa(f.q,f));d=P(d,e,f,a.z);e=a;for(f=I(c)-2;0<f;--f){var e=la(e),g=V(c,f),h=V(b,f);g!==h&&(e=X(e,g?a:d))}return e}function q(a){a=new Uint8Array(a);var b=n(8*a.length/28);b.t=0;for(var c=b.s=0,d=0,e=a.length;d<e;d++){var f=a[d];0===c?b[b.t++]=f:28<c+8?(b[b.t-1]|=(f&(1<<28-c)-1)<<c,b[b.t++]=f>>28-c):b[b.t-1]|=f<<c;c+=8;28<=c&&(c-=28)}return u(b)}function Q(a,b){var c,d=!1,e=[],f=a.t,g=28-28*f%8;if(0<f--)for(28>g&&0<(c=a[f]>>g)&&(d=!0,e.push(c));0<=f;)8>g?(c=(a[f]&(1<<g)-1)<<
8-g,c|=a[--f]>>(g+=20)):(c=a[f]>>(g-=8)&255,0>=g&&(g+=28,--f)),0<c&&(d=!0),d&&e.push(c);c=new Uint8Array(b?b/8:e.length);d&&c.set(e.reverse());return c.buffer}function A(a){if("number"===typeof a||a instanceof Number)return C(a);(a=a.replace(/[^\-A-Fa-f0-9]/g,""))||(a="0");for(var b=n(a.length/7),c=a.length,d=!1,e=0;0<=--c;)if("-"===a.charAt(c))d=!0;else{var f=parseInt(a.charAt(c),16),d=!1;0===e?b[b.t++]=f:28<e+4?(b[b.t-1]|=(f&(1<<28-e)-1)<<e,b[b.t++]=f>>28-e):b[b.t-1]|=f<<e;e+=4;28<=e&&(e-=28)}d&&
p(t,b,b);return u(b)}function na(a){if(0>a.s){var b=n(a.t);a=p(t,a,b);return"-"+na(a)}var c=!1,d="",e=a.t,f=28-28*e%4;if(0<e--)for(28>f&&0<(b=a[e]>>f)&&(c=!0,d=b.toString(16));0<=e;)4>f?(b=(a[e]&(1<<f)-1)<<4-f,b|=a[--e]>>(f+=24)):(b=a[e]>>(f-=4)&15,0>=f&&(f+=28,--e)),0<b&&(c=!0),c&&(d+=b.toString(16));return"0x"+(c?d:"0")}function oa(a){a=new Uint8Array(a);for(var b=new Uint8Array(a.length),c=0,d=a.length;c<d;c++)b[d-c-1]=a[c];return b.buffer}function pa(a){this.hash&&(a=this.hash.digest(a));if("SC"===
this.procreator||"VN"===this.procreator&&2012===this.hash.version)a=oa(a);return a}function E(a){if(a instanceof Ba)return a;if(a&&a.buffer&&a.buffer instanceof Ba)return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength?a.buffer:(new Uint8Array(new Uint8Array(a,a.byteOffset,a.byteLength))).buffer;throw new qa("CryptoOperationData or CryptoOperationDataView required");}function ra(a){a=E(a);if(0<a.byteLength%2)throw new qa("Buffer length must be even");var b=a.byteLength/2;return[q(new Uint8Array(a,
0,b)),q(new Uint8Array(a,b,b))]}function sa(a,b,c){a=Q(a,c);b=Q(b,c);c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a));c.set(new Uint8Array(b),a.byteLength);return c.buffer}function ta(a){var b=(K=K||x.GostRandom)?new (K||x.GostRandom):Ga;if(b.getRandomValues)return a=new Uint8Array(Math.ceil(a/8)),b.getRandomValues(a),a;throw new J("Random generator not found");}function Ha(a,b){var c=E(b),d=q(pa.call(this,c)),c=this.q,e=m(q(E(a)),c),d=m(d,c);z(d)&&(d=R);for(var f=t;z(f);){for(var g=
t;z(g);){var h=m(q(this.ukm||ta(this.bitLength)),c);this.curve?(g=ma(this.P,h),g=m(da(g),c)):g=m(ba(this.a,h,this.p),c)}var f=v(g,e),k=v(h,d),f=L(f,k,n(f.t)),f=m(f,c)}if("SC"===this.procreator)h={r:na(g),s:na(f)};else if(h=sa(g,f,this.bitLength),"CP"===this.procreator||"VN"===this.procreator)h=oa(h);return h}function Ia(a,b,c){var d=this.q,e;if("SC"===this.procreator)e=A(b.r),b=A(b.s);else{if("CP"===this.procreator||"VN"===this.procreator)b=oa(b);e=ra(b);b=e[1];e=e[0]}if(0<=s(e,d)||0<=s(b,d))return!1;
c=E(c);c=q(pa.call(this,c));c=m(c,d);0===z(c)&&(c=R);c=aa(c,d);b=m(v(b,c),d);c=fa(d,m(v(e,c),d));if(this.curve){var f=ra(a),g=this.curve;a=this.P;for(var h=w(g,f[0]),f=w(g,f[1]),f=new P(g,h,f),g=I(b)>I(c)?I(b)-1:I(c)-1,h=a.curve.infinity,k=X(a,f);0<=g;)h=la(h),V(b,g)?h=V(c,g)?X(h,k):X(h,a):V(c,g)&&(h=X(h,f)),--g;d=m(da(h),d)}else g=this.p,h=this.a,f=q(a),d=m(m(v(ba(h,b,g),ba(f,c,g)),g),d);return 0===s(d,e)}function Ca(){var a=this.curve;if(a){for(a=a.infinity;W(a);){var b=t;if(this.ukm)b=q(this.ukm);
else for(;z(b);)b=m(q(ta(this.bitLength)),this.q);var a=ma(this.P,b),c=da(a),d=Aa(a)}return{privateKey:Q(b,this.bitLength),publicKey:sa(c,d,this.bitLength)}}throw new J("Key generation for GOST R 34.10-94 not supported");}function Ja(){if(this.curve){for(var a=t;z(a);)a=m(q(ta(this.bitLength)),this.q);return Q(a,this.bitLength)}throw new J("Key generation for GOST R 34.10-94 not supported");}function Ka(a,b){if(this.curve){var c=this.q,d=m(q(E(b)),c),e=m(q(E(a)),c),c="VN"===this.procreator?m(v(d,
e),c):m(v(d,aa(e,c)),c);return Q(c)}throw new J("Key wrapping GOST R 34.10-94 not supported");}function La(a,b){if(this.curve){var c=this.q,d=m(q(E(b)),c),e=m(q(E(a)),c),c="VN"===this.procreator?m(v(d,aa(e,c)),c):m(v(d,e),c);return Q(c)}throw new J("Key wrapping GOST R 34.10-94 not supported");}function Da(a){var b;b=q(this.ukm);var c=this.q;a=m(q(E(a)),c);this.curve?(b=ma(this.peer_Q,m(v(b,a),c)),b=sa(da(b),Aa(b),this.bitLength)):b=Q(ba(this.peer_y,a,this.p));return pa.call(this,b)}function Ma(a,
b){if(8>b||b>this.bitLength||0<b%8)throw new qa("Length must be no more than "+this.bitLength+" bits and multiple of 8");var c=b/8,d=Da.call(this,a),e=new Uint8Array(c);e.set(new Uint8Array(d,0,c));return e.buffer}function Na(a){a=Da.call(this,a);var b=new Uint8Array(32);b.set(new Uint8Array(a,0,32));return b.buffer}var x=this,Ga=x.crypto||x.msCrypto,Ba=x.ArrayBuffer,Ea=x.OperationError||x.Error,qa=x.DataError||x.Error,J=x.NotSupportedError||x.Error,r={"S-256-TEST":{a:7,b:"0x5FBFF498AA938CE739B8E022FBAFEF40563F6E6A3472FC2A514C0CE9DAE23B7E",
p:"0x8000000000000000000000000000000000000000000000000000000000000431",q:"0x8000000000000000000000000000000150FE8A1892976154C59CFC193ACCF5B3",x:2,y:"0x8E2A8A0E65147D4BD6316030E16D19C85C97F0A9CA267122B96ABBCEA7E8FC8"},"S-256-A":{a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD94",b:166,p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD97",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C611070995AD10045841B09B761B893",x:1,y:"0x8D91E471E0989CDA27DF505A453F2B7635294F2DDF23E3B122ACC99C9E9F1E14"},
"S-256-B":{a:"0x8000000000000000000000000000000000000000000000000000000000000C96",b:"0x3E1AF419A269A5F866A7D3C25C3DF80AE979259373FF2B182F49D4CE7E1BBC8B",p:"0x8000000000000000000000000000000000000000000000000000000000000C99",q:"0x800000000000000000000000000000015F700CFFF1A624E5E497161BCC8A198F",x:1,y:"0x3FA8124359F96680B83D1C3EB2C070E5C545C9858D03ECFB744BF8D717717EFC"},"S-256-C":{a:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D7598",b:32858,p:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D759B",
q:"0x9B9F605F5A858107AB1EC85E6B41C8AA582CA3511EDDFB74F02F3A6598980BB9",x:0,y:"0x41ECE55743711A8C3CBF3783CD08C0EE4D4DC440D4641A8F366E550DFDB3BB67"},"P-256":{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",
q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"},"T-512-TEST":{a:7,b:"0x1CFF0806A31116DA29D8CFA54E57EB748BC5F377E49400FDD788B649ECA1AC4361834013B2AD7322480A89CA58E0CF74BC9E540C2ADD6897FAD0A3084F302ADC",p:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DF1D852741AF4704A0458047E80E4546D35B8336FAC224DD81664BBF528BE6373",q:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DA82F2D7ECB1DBAC719905C5EECC423F1D86E25EDBE23C595D644AAF187E6E6DF",x:"0x24D19CC64572EE30F396BF6EBBFD7A6C5213B3B3D7057CC825F91093A68CD762FD60611262CD838DC6B60AA7EEE804E28BC849977FAC33B4B530F1B120248A9A",
y:"0x2BB312A43BD2CE6E0D020613C857ACDDCFBF061E91E5F2C3F32447C259F39B2C83AB156D77F1496BF7EB3351E1EE4E43DC1A18B91B24640B6DBB92CB1ADD371E"},"T-512-A":{p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC7",a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC4",b:"0xE8C2505DEDFC86DDC1BD0B2B6667F1DA34B82574761CB0E879BD081CFD0B6265EE3CB090F30D27614CB4574010DA90DD862EF9D4EBEE4761503190785A71C760",
q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27E69532F48D89116FF22B8D4E0560609B4B38ABFAD2B85DCACDB1411F10B275",x:3,y:"0x7503CFE87A836AE3A61B8816E25450E6CE5E1C93ACF1ABC1778064FDCBEFA921DF1626BE4FD036E93D75E6A50E3A41E98028FE5FC235F5B889A589CB5215F2A4"},"T-512-B":{p:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006F",a:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006C",
b:"0x687D1B459DC841457E3E06CF6F5E2517B97C7D614AF138BCBF85DC806C4B289F3E965D2DB1416D217F8B276FAD1AB69C50F78BEE1FA3106EFB8CCBC7C5140116",q:"0x800000000000000000000000000000000000000000000000000000000000000149A1EC142565A545ACFDB77BD9D40CFA8B996712101BEA0EC6346C54374F25BD",x:2,y:"0x1A8F7EDA389B094C2C071E3647A8940F3C123B697578C213BE6DD9E6C8EC7335DCB228FD1EDF4A39152CBCAAF8C0398828041055F94CEEEC7E21340780FE41BD"}};r["X-256-A"]=r["S-256-A"];r["X-256-B"]=r["S-256-C"];r["T-256-TEST"]=r["S-256-TEST"];r["T-256-A"]=
r["S-256-A"];r["T-256-B"]=r["S-256-B"];r["T-256-C"]=r["S-256-C"];var Oa={"S-TEST":{modulusLength:512,p:"0xEE8172AE8996608FB69359B89EB82A69854510E2977A4D63BC97322CE5DC3386EA0A12B343E9190F23177539845839786BB0C345D165976EF2195EC9B1C379E3",q:"0x98915E7EC8265EDFCDA31E88F24809DDB064BDC7285DD50D7289F0AC6F49DD2D",a:"0x9e96031500c8774a869582d4afde2127afad2538b4b6270a6f7c8837b50d50f206755984a49e509304d648be2ab5aab18ebe2cd46ac3d8495b142aa6ce23e21c"},"S-A":{modulusLength:1024,p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",
q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"},"S-B":{modulusLength:1024,p:"0xC6971FC57524B30C9018C5E621DE15499736854F56A6F8AEE65A7A404632B1BCF0349FFCAFCB0A103177971FC1612ADCDB8C8CC938C70225C8FD12AFF01B1D064E0AD6FDE6AB9159166CB9F2FC171D92F0CC7B6A6B2CD7FA342ACBE2C9315A42D576B1ECCE77A963157F3D0BD96A8EB0B0F3502AD238101B05116334F1E5B7AB",
q:"0xB09D634C10899CD7D4C3A7657403E05810B07C61A688BAB2C37F475E308B0607",a:"0x3D26B467D94A3FFC9D71BF8DB8934084137264F3C2E9EB16DCA214B8BC7C872485336744934FD2EF5943F9ED0B745B90AA3EC8D70CDC91682478B664A2E1F8FB56CEF2972FEE7EDB084AF746419B854FAD02CC3E3646FF2E1A18DD4BEB3C44F7F2745588029649674546CC9187C207FB8F2CECE8E2293F68395C4704AF04BAB5"},"S-C":{modulusLength:1024,p:"0x9D88E6D7FE3313BD2E745C7CDD2AB9EE4AF3C8899E847DE74A33783EA68BC30588BA1F738C6AAF8AB350531F1854C3837CC3C860FFD7E2E106C3F63B3D8A4C034CE73942A6C3D585B599CF695ED7A3C4A93B2B947B7157BB1A1C043AB41EC8566C6145E938A611906DE0D32E562494569D7E999A0DDA5C879BDD91FE124DF1E9",
q:"0xFADD197ABD19A1B4653EECF7ECA4D6A22B1F7F893B641F901641FBB555354FAF",a:"0x7447ED7156310599070B12609947A5C8C8A8625CF1CF252B407B331F93D639DDD1BA392656DECA992DD035354329A1E95A6E32D6F47882D960B8F10ACAFF796D13CD9611F853DAB6D2623483E46788708493937A1A29442598AEC2E0742022563440FE9C18740ECE6765AC05FAF024A64B026E7E408840819E962E7E5F401AE3"},"S-D":{modulusLength:1024,p:"0x80F102D32B0FD167D069C27A307ADAD2C466091904DBAA55D5B8CC7026F2F7A1919B890CB652C40E054E1E9306735B43D7B279EDDF9102001CD9E1A831FE8A163EED89AB07CF2ABE8242AC9DEDDDBF98D62CDDD1EA4F5F15D3A42A6677BDD293B24260C0F27C0F1D15948614D567B66FA902BAA11A69AE3BCEADBB83E399C9B5",
q:"0xF0F544C418AAC234F683F033511B65C21651A6078BDA2D69BB9F732867502149",a:"0x6BCC0B4FADB3889C1E06ADD23CC09B8AB6ECDEDF73F04632595EE4250005D6AF5F5ADE44CB1E26E6263C672347CFA26F9E9393681E6B759733784CDE5DBD9A14A39369DFD99FA85CC0D10241C4010343F34A91393A706CF12677CBFA1F578D6B6CFBE8A1242CFCC94B3B653A476E145E3862C18CC3FED8257CFEF74CDB205BF1"},"X-A":{modulusLength:1024,p:"0xCA3B3F2EEE9FD46317D49595A9E7518E6C63D8F4EB4D22D10D28AF0B8839F079F8289E603B03530784B9BB5A1E76859E4850C670C7B71C0DF84CA3E0D6C177FE9F78A9D8433230A883CD82A2B2B5C7A3306980278570CDB79BF01074A69C9623348824B0C53791D53C6A78CAB69E1CFB28368611A397F50F541E16DB348DBE5F",
q:"0xCAE4D85F80C147704B0CA48E85FB00A9057AA4ACC44668E17F1996D7152690D9",a:"0xBE27D652F2F1E339DA734211B85B06AE4DE236AA8FBEEB3F1ADCC52CD43853777E834A6A518138678A8ADBD3A55C70A7EAB1BA7A0719548677AAF4E609FFB47F6B9D7E45B0D06D83D7ADC53310ABD85783E7317F7EC73268B6A9C08D260B85D8485696CA39C17B17F044D1E050489036ABD381C5E6BF82BA352A1AFF136601AF"},"X-B":{modulusLength:1024,p:"0x9286DBDA91ECCFC3060AA5598318E2A639F5BA90A4CA656157B2673FB191CD0589EE05F4CEF1BD13508408271458C30851CE7A4EF534742BFB11F4743C8F787B11193BA304C0E6BCA25701BF88AF1CB9B8FD4711D89F88E32B37D95316541BF1E5DBB4989B3DF13659B88C0F97A3C1087B9F2D5317D557DCD4AFC6D0A754E279",
q:"0xC966E9B3B8B7CDD82FF0F83AF87036C38F42238EC50A876CD390E43D67B6013F",a:"0x7E9C3096676F51E3B2F9884CF0AC2156779496F410E049CED7E53D8B7B5B366B1A6008E5196605A55E89C3190DABF80B9F1163C979FCD18328DAE5E9048811B370107BB7715F82091BB9DE0E33EE2FED6255474F8769FCE5EAFAEEF1CB5A32E0D5C6C2F0FC0B3447072947F5B4C387666993A333FC06568E534AD56D2338D729"},"X-C":{modulusLength:1024,p:"0xB194036ACE14139D36D64295AE6C50FC4B7D65D8B340711366CA93F383653908EE637BE428051D86612670AD7B402C09B820FA77D9DA29C8111A8496DA6C261A53ED252E4D8A69A20376E6ADDB3BDCD331749A491A184B8FDA6D84C31CF05F9119B5ED35246EA4562D85928BA1136A8D0E5A7E5C764BA8902029A1336C631A1D",
q:"0x96120477DF0F3896628E6F4A88D83C93204C210FF262BCCB7DAE450355125259",a:"0x3F1817052BAA7598FE3E4F4FC5C5F616E122CFF9EBD89EF81DC7CE8BF56CC64B43586C80F1C4F56DD5718FDD76300BE336784259CA25AADE5A483F64C02A20CF4A10F9C189C433DEFE31D263E6C9764660A731ECCAECB74C8279303731E8CF69205BC73E5A70BDF93E5BB681DAB4EEB9C733CAAB2F673C475E0ECA921D29782E"}},Fa=Math.pow(2,52),t=C(0),R=C(1),ea=C(3),wa=function(a){this.m=a};ja(wa,{convert:function(a){return 0>a.s||0<=s(a,this.m)?m(a,this.m):a},revert:function(a){return a},
reduce:function(a){va(a,this.m,a)},sqrTo:function(a,b){$(a,b);this.reduce(b)},mulTo:function(a,b,c){Z(a,b,c);this.reduce(c)}});var xa=function(a){this.m=a;var b;if(1>a.t)b=0;else if(b=a[0],0===(b&1))b=0;else{var c=b&3,c=c*(2-(b&15)*c)&15,c=c*(2-(b&255)*c)&255,c=c*(2-((b&65535)*c&65535))&65535,c=c*(2-b*c%268435456)%268435456;b=0<c?268435456-c:-c}this.mp=b;this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=8191;this.mt2=2*a.t};ja(xa,{convert:function(a){var b=n(a.t);U(M(a),this.m.t,b);ia(b,this.m,
null,b);0>a.s&&0<s(b,t)&&p(this.m,b,b);return b},revert:function(a){var b=n(a.t);G(a,b);this.reduce(b);return b},reduce:function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&268435455,c=b+this.m.t;for(a[c]+=B(this.m,0,d,a,b,0,this.m.t);268435456<=a[c];)a[c]-=268435456,a[++c]++}u(a);Y(a,this.m.t,a);0<=s(a,this.m)&&p(a,this.m,a)},sqrTo:function(a,b){$(a,b);this.reduce(b)},mulTo:function(a,b,c){Z(a,b,c);this.reduce(c)}});
ja(ka,{convert:function(a){if(0>a.s||a.t>2*this.m.t)return m(a,this.m);if(0>s(a,this.m))return a;var b=n(a.t);G(a,b);this.reduce(b);return b},revert:function(a){return a},reduce:function(a){Y(a,this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,u(a));var b=this.mu,c=this.r2,d=this.m.t+1,e=this.q3;--d;var f=e.t=b.t+c.t-d;for(e.s=0;0<=--f;)e[f]=0;for(f=Math.max(d-b.t,0);f<c.t;++f)e[b.t+f-d]=B(b,d-f,c[f],e,0,0,b.t+f-d);u(e);Y(e,1,e);b=this.m;c=this.q3;d=this.m.t+1;e=this.r2;f=Math.min(b.t+c.t,d);e.s=
0;for(e.t=f;0<f;)e[--f]=0;var g;for(g=e.t-b.t;f<g;++f)e[f+b.t]=B(b,0,c[f],e,f,0,b.t);for(g=Math.min(c.t,d);f<g;++f)B(b,0,c[f],e,f,0,d-f);for(u(e);0>s(a,this.r2);){b=a;for(c=this.m.t+1;b.t<=c;)b[b.t++]=0;for(b[c]+=1;268435456<=b[c];)b[c]-=268435456,++c>=b.t&&(b[b.t++]=0),++b[c]}for(p(a,this.r2,a);0<=s(a,this.m);)p(a,this.m,a)},sqrTo:function(a,b){$(a,b);this.reduce(b)},mulTo:function(a,b,c){Z(a,b,c);this.reduce(c)}});return function(a){a=a||{};this.name=(a.name||"GOST R 34.10")+"-"+(a.version||2012)%
100+"-"+(a.length||256)+("SIGN"!==(a.mode||"SIGN")?"-"+a.mode:"")+("string"===typeof a.namedParam?"/"+a.namedParam:"")+("string"===typeof a.namedCurve?"/"+a.namedCurve:"")+("string"===typeof a.sBox?"/"+a.sBox:"");var b=a.version||2012;switch(a.mode||"SIGN"){case "SIGN":this.sign=Ha;this.verify=Ia;this.generateKey=Ca;break;case "DH":this.deriveBits=Ma;this.deriveKey=Na;this.generateKey=Ca;break;case "MASK":this.wrapKey=La,this.unwrapKey=Ka,this.generateKey=Ja}if(1994===b)b=a.param,b||(b=Oa[this.namedParam=
(a.namedParam||"S-A").toUpperCase()]),this.modulusLength=a.modulusLength||b.modulusLength||1024,this.p=A(b.p),this.q=A(b.q),this.a=A(b.a),a["public"]&&(this.peer_y=q(a["public"]));else{b=a.curve;b||(b=r[this.namedCurve=(a.namedCurve||"S-256-A").toUpperCase()]);var c=A(b.p),d=A(b.a),e=A(b.b),f={};f.q=c;f.r=new ka(c);f.a=w(f,d);f.b=w(f,e);f.infinity=P(f);c=this.curve=f;this.P=P(c,w(c,A(b.x)),w(c,A(b.y)));this.q=A(b.q);a["public"]&&(b=ra(a["public"]),this.peer_Q=new P(this.curve,w(this.curve,b[0]),w(this.curve,
b[1])))}if(this.curve){c=a.length||I(this.q);if(508<c&&512>=c)c=512;else if(254<c&&256>=c)c=256;else throw new J("Support keys only 256 or 512 bits length");b=c}else{c=a.modulusLength||I(this.p);if(1016<c&&1024>=c)c=1024;else if(508<c&&512>=c)c=512;else throw new J("Support keys only 512 or 1024 bits length");b=256}this.bitLength=b;this.keyLength=c;this.procreator=a.procreator;if(c=a.hash){if("string"===typeof c||c instanceof String)c={name:c};1994===a.version||2001===a.version?(c.version=1994,c.length=
256,c.sBox=a.sBox||c.sBox):(c.version=2012,c.length=b);c.procreator=c.procreator||a.procreator;F||(F=x.GostDigest);if(!F)throw new J("Object GostDigest not found");this.hash=new F(c)}a.ukm&&(this.ukm=a.ukm)}});
